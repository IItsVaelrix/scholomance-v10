import{a as b,b as C,c as k,d as w,j as s,A as I,m as h,r as m,u as E,C as p,g as N}from"./index-DJ7VUbM-.js";function S(e){e.values.forEach(i=>i.stop())}function A(){const e=new Set,i={subscribe(l){return e.add(l),()=>{e.delete(l)}},start(l,c){const a=[];return e.forEach(r=>{a.push(C(r,l,{transitionOverride:c}))}),Promise.all(a)},set(l){return e.forEach(c=>{b(c,l)})},stop(){e.forEach(l=>{S(l)})},mount(){return()=>{i.stop()}}};return i}function L(){const e=k(A);return w(e.mount,[]),e}const O=L;function T({value:e,index:i=0}){const l=e===".";return s.jsxs("div",{className:`nixie-tube ${l?"nixie-tube--decimal":""}`,children:[s.jsx("div",{className:"nixie-glass"}),s.jsx(I,{mode:"wait",children:s.jsx(h.span,{className:"nixie-digit",initial:{opacity:0,y:-15,scale:.8},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:15,scale:.8},transition:{duration:.15,delay:i*.03},children:e},e)}),s.jsx("div",{className:"nixie-reflection"})]})}function $({school:e,onTune:i,disabled:l}){const c=()=>{l||i?.()};return s.jsxs("div",{className:"brass-dial-container",children:[s.jsx("div",{className:"gear-ring",children:Array.from({length:24}).map((a,r)=>s.jsx("div",{className:"gear-tooth",style:{transform:`rotate(${r*15}deg) translateY(-108px)`}},r))}),s.jsxs("div",{className:"brass-dial",onClick:c,role:"button",tabIndex:0,"aria-label":`Tune to ${e} frequency`,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),c())},children:[s.jsx("div",{className:"dial-engravings",children:["VOID","PSYCH","ALCH","WILL","SONIC"].map((a,r)=>s.jsx("span",{className:"dial-marking",style:{transform:`rotate(${r*72}deg) translateY(-65px)`},children:a},a))}),s.jsx("div",{className:"dial-center",children:s.jsxs("div",{className:"dial-knob",children:[s.jsx("div",{className:"knob-grip"}),s.jsx("div",{className:"knob-grip",style:{transform:"rotate(60deg)"}}),s.jsx("div",{className:"knob-grip",style:{transform:"rotate(120deg)"}})]})}),s.jsx("div",{className:"dial-needle"})]}),[0,90,180,270].map(a=>s.jsx("div",{className:"rivet rivet--dial",style:{transform:`rotate(${a}deg) translateY(-95px)`}},a))]})}function H({trackId:e,color:i}){const[l,c]=m.useState(!1),a=encodeURIComponent(e),r=i.replace("#","");return m.useEffect(()=>{c(!1)},[e]),s.jsxs("div",{className:`holo-panel ${l?"is-ready":"is-loading"}`,children:[s.jsx("div",{className:"holo-shimmer"}),!l&&s.jsxs("div",{className:"holo-loading",children:[s.jsx("span",{className:"loading-sigil","aria-hidden":"true",children:"â§—"}),s.jsx("span",{className:"loading-text",children:"Tuning aether..."})]}),s.jsx("div",{className:"holo-panel-inner",children:s.jsx("iframe",{title:"SoundCloud player",src:`https://w.soundcloud.com/player/?url=${a}&color=%23${r}&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=false`,allow:"autoplay",className:"holo-embed",onLoad:()=>c(!0)})}),s.jsx("div",{className:"holo-scanline"})]})}function D(){const{currentKey:e,currentSong:i,setCurrentKey:l,library:c}=E(),[a,r]=m.useState(!1),x=O(),v=p[i.school]||p.VOID,f=N("school",i.school),u=m.useMemo(()=>Object.entries(c||{}),[c]),j=async(t,n)=>{a||(r(!0),l(n),await x.start({x:[0,-4,4,-2,2,0],y:[0,2,-2,1,-1,0],transition:{duration:.42}}),r(!1))},g=t=>({VOID:"00.0",PSYCHIC:"72.0",ALCHEMY:"144",WILL:"216",SONIC:"288"})[t]||"00.0";return s.jsx("section",{className:`listenPage surface ${f}`,"data-surface":"listen",children:s.jsxs("article",{className:"container surface","data-surface":"listen-shell",children:[s.jsxs("header",{className:"sectionHeader surface","data-surface":"listen-header",children:[s.jsx("div",{className:"kicker",children:"Aetheric Frequency Modulator"}),s.jsx("h1",{className:"title",children:"Tune the school. Lock the signal."}),s.jsx("p",{className:"subtitle",children:"Rotate the brass dial to cycle frequencies, or select a track below for precise calibration."})]}),s.jsxs(h.div,{className:"radio-cabinet",animate:x,children:[s.jsx("div",{className:"radio-glow","aria-hidden":"true"}),s.jsxs("div",{className:"nixie-panel",children:[s.jsx("div",{className:"nixie-label",children:"FREQUENCY"}),s.jsx("div",{className:"nixie-display",children:g(i.school).split("").map((t,n)=>s.jsx(T,{value:t,index:n},n))}),s.jsx("div",{className:"nixie-unit",children:"MHz"})]}),s.jsxs("div",{className:"radio-main",children:[s.jsxs("div",{className:"dial-section",children:[s.jsx($,{school:i.school,onTune:()=>{const t=u.map(([y])=>y),n=Math.max(0,t.indexOf(e)),o=t[(n+1)%t.length],d=c[o];d&&j(d.school,o)},disabled:a}),s.jsxs("div",{className:"dial-label",children:[s.jsx("span",{className:"dial-school",children:i.school}),s.jsx("span",{className:"dial-status",children:"LOCKED"})]})]}),s.jsxs("div",{className:"player-section",children:[s.jsxs("div",{className:"player-header",children:[s.jsx("h3",{className:"player-title",children:i.title}),s.jsxs("div",{className:"oscilloscope",children:[s.jsx("div",{className:"oscilloscope-wave"}),s.jsx("div",{className:"oscilloscope-grid"})]})]}),s.jsx(H,{trackId:i.sc,color:v}),s.jsx("div",{className:"vacuum-visualizer",children:Array.from({length:14}).map((t,n)=>s.jsx(h.div,{className:"vacuum-bar",animate:a?{height:10}:{height:[10,50,20,60,15]},transition:{duration:.55,repeat:1/0,repeatType:"mirror",delay:n*.05,ease:"easeInOut"}},n))})]})]}),s.jsxs("div",{className:"track-panel",children:[s.jsxs("div",{className:"track-panel-header",children:[s.jsx("span",{className:"rivet"}),s.jsx("span",{className:"track-panel-title",children:"SIGNAL ARCHIVE"}),s.jsx("span",{className:"rivet"})]}),s.jsx("div",{className:"trackGrid",children:u.map(([t,n])=>{const o=t===e,d=N("school",n.school);return s.jsxs("button",{className:`trackCard ${d} ${o?"trackCardActive":""}`,onClick:()=>j(n.school,t),disabled:a,children:[s.jsxs("div",{className:"trackTop",children:[s.jsx("span",{className:"vacuum-indicator"}),s.jsx("p",{className:"trackTitle",children:n.title})]}),s.jsxs("div",{className:"trackMeta",children:[n.school," FREQ"]})]},t)})})]}),s.jsxs("div",{className:"cabinet-screws",children:[s.jsx("span",{className:"screw screw-tl"}),s.jsx("span",{className:"screw screw-tr"}),s.jsx("span",{className:"screw screw-bl"}),s.jsx("span",{className:"screw screw-br"})]})]})]})})}export{D as default};
